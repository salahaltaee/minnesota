<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>الأسئلة</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css" rel="stylesheet">

  <!-- ✅ ربط ملف الأسئلة -->
  <script src="questions-data.js"></script>
</head>
<body class="bg-light p-3">
  <div class="container">
    <h3 class="text-center my-4">الأسئلة</h3>

    <form id="questionForm"></form>

    <div class="d-flex justify-content-between mt-4">
      <button class="btn btn-secondary" id="prevBtn" disabled>السابق</button>
      <button class="btn btn-primary" id="nextBtn">التالي</button>
    </div>
  </div>

  <!-- ✅ سكربت التشغيل -->
  <script>
    const form = document.getElementById("questionForm");
    const nextBtn = document.getElementById("nextBtn");
    const prevBtn = document.getElementById("prevBtn");

    let currentPage = 0;
    const totalPages = allQuestions.length;
    const allAnswers = [];

    function renderPage(pageIndex) {
      form.innerHTML = "";
      const questions = allQuestions[pageIndex];
      questions.forEach((question, i) => {
        const qIndex = pageIndex * 10 + i;
        const savedAnswer = allAnswers[qIndex] || "";
        form.innerHTML += `
          <div class="mb-4">
            <label class="form-label"><strong>${qIndex + 1}.</strong> ${question}</label>
            <div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="q${qIndex}" value="نعم" ${savedAnswer === "نعم" ? "checked" : ""} />
                <label class="form-check-label">نعم</label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="q${qIndex}" value="لا" ${savedAnswer === "لا" ? "checked" : ""} />
                <label class="form-check-label">لا</label>
              </div>
            </div>
          </div>`;
      });

      prevBtn.disabled = pageIndex === 0;
      nextBtn.textContent = (pageIndex === totalPages - 1) ? "إنهاء" : "التالي";
    }

    function saveCurrentAnswers() {
      const inputs = form.querySelectorAll("input[type=radio]:checked");
      inputs.forEach(input => {
        const index = parseInt(input.name.replace("q", ""));
        allAnswers[index] = input.value;
      });
    }

    nextBtn.addEventListener("click", () => {
      saveCurrentAnswers();
      if (currentPage === totalPages - 1) {
        localStorage.setItem("answers", JSON.stringify(allAnswers));
        alert("✅ تم حفظ إجاباتك، سيتم توجيهك إلى صفحة النتيجة.");
        window.location.href = "result.html";
      } else {
        currentPage++;
        renderPage(currentPage);
      }
    });

    prevBtn.addEventListener("click", () => {
      saveCurrentAnswers();
      if (currentPage > 0) {
        currentPage--;
        renderPage(currentPage);
      }
    });

    renderPage(currentPage);
  </script>
</body>
</html>
